  <script>
    // URL base do seu backend no Cloud Run (NÃO colocar /create-checkout-session aqui)
    const CLOUD_RUN_URL = "https://create-checkout-session-467345148998.europe-west1.run.app";

    async function handleUpgradeClick() {
      const btn = document.getElementById('upgrade-btn');
      const statusEl = document.getElementById('status');
      try {
        btn.disabled = true;
        statusEl.textContent = 'Redirecionando para o Stripe...';

        const resp = await fetch(CLOUD_RUN_URL + '/create-checkout-session', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            email: 'teste.hokmah+cli@gmail.com' // depois trocamos para o e-mail real do usuário logado
          }),
        });

        if (!resp.ok) {
          const txt = await resp.text();
          throw new Error('Erro HTTP ' + resp.status + ': ' + txt);
        }

        const data = await resp.json();
        if (!data.url) {
          throw new Error('Resposta sem URL de checkout');
        }

        window.location.href = data.url; // abre o Stripe Checkout
      } catch (err) {
        console.error(err);
        statusEl.textContent = 'Erro ao redirecionar: ' + err.message;
        btn.disabled = false;
      }
    }
  </script>
</body>
</html>
