<script>
  const CLOUD_RUN_URL = 'https://create-checkout-session-467345148998.europe-west1.run.app/create-checkout-session';
  const ORIGIN = 'https://hokmah-expositor-web--gen-lang-client-0187133986.us-east4.hosted.app';

  document.getElementById('go').onclick = async () => {
    const out = document.getElementById('out');
    out.textContent = 'Chamandoâ€¦';
    try {
      const r = await fetch(CLOUD_RUN_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          uid: 'teste-uid-123',
          success_url: ORIGIN + '/sucesso.html',
          cancel_url:  ORIGIN + '/cancelado.html'
        })
      });
      const data = await r.json().catch(() => ({}));
      out.textContent = `HTTP ${r.status}\n${JSON.stringify(data, null, 2)}`;
      if (r.ok && data.url) location.href = data.url;
    } catch (e) {
      out.textContent = 'Erro: ' + e;
    }
  };
</script>

